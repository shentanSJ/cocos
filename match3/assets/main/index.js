System.register("bundle://main/_virtual/BaseGridItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,a,r,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,c=t.Animation,l=t.Component}],execute:function(){var p,s,u;a._RF.push({},"45648GThn5KOKCFXtNotryZ","BaseGridItem",void 0);var m=r.ccclass,f=r.property;t("BaseGridItem",m("BaseGridItem")((u=e((s=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"itemType",u,o(e)),e}n(e,t);var a=e.prototype;return a.getItemType=function(){return this.itemType},a.setItemType=function(t){this.itemType=t},a.onPlacedInCell=function(t){this.playAnimation("placed")},a.onItemSelected=function(){this.playAnimation("click")},a.onAddGridItem=function(t){this.playAnimation("ItemAdded")},a.onRemovedFromCell=function(){this.playAnimation("removed")},a.onCellInteraction=function(t){this.playAnimation("interacted")},a.onCustomEvent=function(t,e){this.playAnimation(t)},a.activateSpecialEffect=function(){this.playAnimation("special_effect")},a.canMatchWith=function(t){return!0},a.playAnimation=function(t){var e=this.node.getComponent(c);e&&e.getState(t)&&e.play(t)},e}(l)).prototype,"itemType",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),p=s))||p);a._RF.pop()}}}));

System.register("bundle://main/_virtual/env",[],(function(e){return{execute:function(){e("DEV",!1)}}}));

System.register("bundle://main/_virtual/GameBoard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDataStructures.ts"],(function(t){var e,i,o,s,r;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,i=t.createClass},function(t){o=t.cclegacy,s=t._decorator},function(t){r=t.GridItemFlags}],execute:function(){var a;o._RF.push({},"56976t0q5pHpoVUvlI+8xVf","GameBoard",void 0);var h=s.ccclass;s.property,t("GameBoard",h("GameBoard")(a=function(){function t(t,e,i){this.board=void 0,this.itemTypes=void 0,this.cumulativeWeights=[],this.totalWeight=0,this.itemTypes=i,this.board={rows:t,cols:e,items:[]},this.precomputeWeights(),this.initializeItems()}var o=t.prototype;return o.precomputeWeights=function(){this.cumulativeWeights=[],this.totalWeight=0;for(var t,i=e(this.itemTypes.entries());!(t=i()).done;){var o=t.value,s=o[0],r=o[1];this.totalWeight+=r,this.cumulativeWeights.push({type:s,cumulativeWeight:this.totalWeight})}},o.initializeItems=function(){for(var t=this.board.rows,e=this.board.cols,i=this.board.items,o=t*e,s=this.getRandomItemTypesBulk(o),a=0,h=0;h<t;h++){for(var n=[],u=0;u<e;u++)n.push({type:s[a++],flags:r.SELECTABLE});i.push(n)}},o.getRandomItemTypesBulk=function(t){var e=this;return Array.from({length:t},(function(){return e.getRandomItemTypeByWeight()}))},o.getRandomItemTypeByWeight=function(){for(var t=Math.random()*this.totalWeight,e=0,i=this.cumulativeWeights.length-1;e<i;){var o=Math.floor((e+i)/2);t<=this.cumulativeWeights[o].cumulativeWeight?i=o:e=o+1}return this.cumulativeWeights[e].type},o.getItem=function(t){return this.board.items[t.row][t.col]},o.updateWeights=function(t){this.itemTypes=t,this.precomputeWeights()},o.swapItems=function(t,e){this._swapItems(t,e)},o._swapItems=function(t,e){var i=this.board.items[t.row][t.col],o=this.board.items[e.row][e.col];this.board.items[t.row][t.col]=o,this.board.items[e.row][e.col]=i},o.removeItems=function(t){this._removeItems(t)},o._removeItems=function(t){for(var i,o=e(t);!(i=o()).done;){var s=i.value,a=s.row,h=s.col;this.board.items[a][h].flags=r.NONE,this.board.items[a][h].type=-1}},o._updateItem=function(t,e){this.board.items[t.row][t.col]=e},o.addItem=function(t,e){-1===this.board.items[t.row][t.col].type&&this._updateItem(t,e)},o.colItemsDown=function(t){for(var e=[],i=[],o=[],s=this.rows-1;s>=0;--s)-1===this.board.items[s][t].type?e.push(s):e.length>0&&i.push(s);for(var r=0;r<i.length;r++){var a=i[r],h={type:this.board.items[a][t].type,flags:this.board.items[a][t].flags},n={row:a,col:t},u={row:e[0]-r,col:t};o.push({from:n,to:u,item:h}),this._updateItem(u,h)}for(var m=0;m<e.length;m++)this.items[m][t].type=-1;return[[].concat(o),e.length]},i(t,[{key:"rows",get:function(){return this.board.rows}},{key:"cols",get:function(){return this.board.cols}},{key:"items",get:function(){return this.board.items}}]),t}())||a);o._RF.pop()}}}));

System.register("bundle://main/_virtual/GameConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogger.ts"],(function(e){var t,a,r,n,s,i,h,o,c,u,l,f,m;return{setters:[function(e){t=e.inheritsLoose,a=e.createForOfIteratorHelperLoose,r=e.wrapNativeSuper},function(e){n=e.cclegacy,s=e._decorator,i=e.resources,h=e.JsonAsset,o=e.SpriteFrame,c=e.ImageAsset,u=e.Texture2D,l=e.Prefab,f=e.AudioClip},function(e){m=e.GameLogger}],execute:function(){var g,p;n._RF.push({},"c40fdRXSOtODI4tDrxLUt0c","GameConfig",void 0);var d=s.ccclass;s.property,e("GameConfig",d("GameConfig")(((p=function(e){function r(){return e.apply(this,arguments)||this}return t(r,e),r.createItemTypeWeightsMap=function(e){if(!e)return m.error("No theme config loaded, create an empty Map!"),new Map;var t=new Map,a=e.itemTypeWeights||[],r=e.itemPrefabPaths.length;if(0===a.length)for(var n=0;n<r;n++)t.set(n,1);else{for(var s=0;s<Math.min(a.length,r);s++)t.set(s,a[s]);for(var i=a.length;i<r;i++)t.set(i,1)}return t},r.getLastThemeId=function(){try{return localStorage.getItem(this.LAST_THEME_KEY)||"default"}catch(e){return"default"}},r.saveLastThemeId=function(e){try{localStorage.setItem(this.LAST_THEME_KEY,e)}catch(e){}},r.loadThemeConfig=function(e,t){var a=this,r="themes/"+e+"/config";i.load(r,h,(function(e,r){if(e)t(null);else{var n=r.json;a.currentTheme=n,t(n)}}))},r.getCurrentTheme=function(){return this.currentTheme},r.loadBackgroundImage=function(e){var t=this;if(this.currentTheme){var a=this.prependThemePath(this.currentTheme.backgroundPath);if(a)if(this.assetCache.has(a))e(this.assetCache.get(a));else{var r=a.endsWith("/spriteFrame")?a:a+"/spriteFrame";i.load(r,o,(function(r,n){if(!r)return t.assetCache.set(a,n),void e(n);t.loadImageAsSpriteFrame(a,e)}))}else e(null)}else e(null)},r.loadImageAsSpriteFrame=function(e,t){var a=this;i.load(e,c,(function(r,n){if(r)t(null);else{var s=new o,i=new u;i.image=n,s.texture=i,a.assetCache.set(e,s),t(s)}}))},r.loadItemPrefabs=function(e){var t=this;if(this.currentTheme){var r=this.currentTheme.itemPrefabPaths.map((function(e){return t.prependThemePath(e)}));if(r&&0!==r.length){for(var n,s=[],h=!0,o=a(r);!(n=o()).done;){var c=n.value;if(!this.assetCache.has(c)){h=!1;break}s.push(this.assetCache.get(c))}h?e(s):i.load(r,l,(function(a,n){if(a)e(null);else{for(var s=0;s<r.length;s++)t.assetCache.set(r[s],n[s]);e(n)}}))}else e(null)}else e(null)},r.loadAudioClip=function(e,t){var a=this;if(this.currentTheme){var r=this.prependThemePath(this.currentTheme.audioPaths[e]);r?this.assetCache.has(r)?t(this.assetCache.get(r)):i.load(r,f,(function(e,n){e?t(null):(a.assetCache.set(r,n),t(n))})):t(null)}else t(null)},r.clearCache=function(){this.assetCache.clear()},r.getAvailableThemes=function(e){i.loadDir("themes",(function(t,a){if(t)e([]);else{var r=new Set;e(Array.from(r))}}))},r.prependThemePath=function(e){return e&&this.currentTheme?e.startsWith("themes/")?e:"themes/"+this.currentTheme.themeId+"/"+e:e},r}(r(Object))).LAST_THEME_KEY="match_three_last_theme",p.currentTheme=null,p.assetCache=new Map,g=p))||g);n._RF.pop()}}}));

System.register("bundle://main/_virtual/GameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridManager.ts","./GameConfig.ts","./GameLogger.ts","./GridGameLogic.ts","./GameBoard.ts"],(function(e){var o,a,r,i,n,t,l,d,u,s,c,g,m,f,h,p;return{setters:[function(e){o=e.applyDecoratedDescriptor,a=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,t=e._decorator,l=e.Node,d=e.AudioSource,u=e.tween,s=e.Sprite,c=e.Component},function(e){g=e.GridManager},function(e){m=e.GameConfig},function(e){f=e.GameLogger},function(e){h=e.GridGameLogic},function(e){p=e.GameBoard}],execute:function(){var G,b,C,v,L,M,w,y,P;n._RF.push({},"735bf8yxWREfpH0xZoxkuuB","GameController",void 0);var B=t.ccclass,S=t.property;e("GameController",(G=B("GameController"),b=S(g),C=S({type:l}),v=S({type:d}),G((w=o((M=function(e){function o(){for(var o,a=arguments.length,n=new Array(a),t=0;t<a;t++)n[t]=arguments[t];return o=e.call.apply(e,[this].concat(n))||this,r(o,"gridManager",w,i(o)),o.gridGameLogic=null,o.itemPrefabs=[],o.gameBoard=null,o.themeConfig=null,o.prefabsLoadedPromise=null,o.prefabsLoadedResolver=null,r(o,"backgroundNode",y,i(o)),r(o,"audioSource",P,i(o)),o}a(o,e);var n=o.prototype;return n.start=function(){var e=this;if(this.gridManager){this.gridGameLogic=new h,this.gridManager.setGridGameLogic(this.gridGameLogic);var o=performance.now();f.log("Game started at "+o);var a=m.getLastThemeId();m.loadThemeConfig(a,(function(o){if(o){e.themeConfig=o;var a=performance.now();f.log("Theme config loading end at "+a),e.loadItemPrefabs(),e.loadGameBackground(),e.loadAudioClip(),e.startNewGame()}}))}else f.error("GridManager component is missing,  game cannot start")},n.startNewGame=function(){var e,o=this,a=m.createItemTypeWeightsMap(this.themeConfig),r=this.themeConfig.rowCount||9,i=this.themeConfig.columnCount||9;(this.gameBoard=new p(r,i,a),this.gridGameLogic.setGameBoard(this.gameBoard),this.gridManager)&&(this.gridManager.setRows(r),this.gridManager.setColumns(i),this.gridManager.initializeGrid(),this.gridManager.setGridGameLogic(this.gridGameLogic),null==(e=this.prefabsLoadedPromise)||e.then((function(){o.gridManager.setPrefabs(o.itemPrefabs),o.populateGrid(r,i)})).then((function(){u({}).call((function(){var e=o.gridGameLogic.findAllMatchesInGrid();e.length>0&&o.gridManager.handleMatchedCells(e)})).start()})))},n.loadGameBackground=function(){var e=this;m.loadBackgroundImage((function(o){if(o&&e.backgroundNode){var a=e.backgroundNode.getComponent(s);a?a.spriteFrame=o:f.warn("Background node does not have a Sprite component")}}))},n.loadItemPrefabs=function(){var e=this;this.prefabsLoadedPromise=new Promise((function(o){e.prefabsLoadedResolver=o})),m.loadItemPrefabs((function(o){o?(e.itemPrefabs=o,f.log("Loaded "+o.length+" item prefabs")):f.error("Failed to load item prefabs"),f.log("Prefab resources loaded at time "+performance.now()),e.prefabsLoadedResolver&&e.prefabsLoadedResolver()}))},n.loadAudioClip=function(){var e=this;m.loadAudioClip("backgroundMusic",(function(o){o&&e.audioSource&&(e.audioSource.clip=o,e.audioSource.loop=!0,e.audioSource.play()),f.log("Audio resources loaded at time "+performance.now())}))},n.populateGrid=function(e,o){for(var a=this.gridManager.getAllCellComponents(),r=this.gameBoard.items,i=0;i<Math.min(e,a.length);i++)for(var n=a[i],t=r[i],l=0;l<Math.min(o,n.length,t.length);l++){var d=t[l].type;this.gridManager.placePrefabInCell(this.itemPrefabs[d],i,l)}},n.playSound=function(e){var o=this;m.loadAudioClip(e,(function(e){e&&o.audioSource&&o.audioSource.playOneShot(e)}))},n.changeTheme=function(e){var o=this;m.clearCache(),m.loadThemeConfig(e,(function(e){e&&(o.loadGameBackground(),o.loadItemPrefabs(),o.loadAudioClip(),e.rowCount===o.themeConfig.rowCount&&e.columnCount===o.themeConfig.columnCount||(o.themeConfig=e,o.startNewGame()))}))},o}(c)).prototype,"gridManager",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=o(M.prototype,"backgroundNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=o(M.prototype,"audioSource",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=M))||L));n._RF.pop()}}}));

System.register("bundle://main/_virtual/GameDataStructures.ts",["cc"],(function(E){var t;return{setters:[function(E){t=E.cclegacy}],execute:function(){t._RF.push({},"5bcfdFO+lNLvqF08BuKfyAu","GameDataStructures",void 0);E("GridItemFlags",function(E){return E[E.NONE=0]="NONE",E[E.SELECTABLE=1]="SELECTABLE",E[E.MOVABLE=2]="MOVABLE",E[E.DESTRUCTIBLE=4]="DESTRUCTIBLE",E[E.FROZEN=8]="FROZEN",E[E.LOCKED=16]="LOCKED",E[E.POWER_UP=32]="POWER_UP",E[E.EXPLODING=64]="EXPLODING",E[E.FALLING=128]="FALLING",E[E.SWAPPING=256]="SWAPPING",E[E.MATCHED=512]="MATCHED",E}({}));t._RF.pop()}}}));

System.register("bundle://main/_virtual/GameLogger.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env"],(function(n){var e,o,r,t,g,i;return{setters:[function(n){e=n.inheritsLoose},function(n){o=n.cclegacy,r=n._decorator,t=n.log,g=n.Component},function(n){i=n.DEV}],execute:function(){var c,u;o._RF.push({},"92601G+iWNNn7IOLtYUUsGY","GameLogger",void 0);var a=r.ccclass;r.property,n("GameLogger",a("GameLogger")(((u=function(n){function o(){return n.apply(this,arguments)||this}return e(o,n),o.enableLogging=function(n){o.loggingEnabled=n},o.log=function(n){o.loggingEnabled&&i&&t(n)},o.error=function(n){},o.warn=function(n){},o}(g)).loggingEnabled=!0,c=u))||c);o._RF.pop()}}}));

System.register("bundle://main/_virtual/GridCell.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogger.ts"],(function(t){var i,r,e,n,o,s;return{setters:[function(t){i=t.inheritsLoose},function(t){r=t.cclegacy,e=t._decorator,n=t.Vec2,o=t.Component},function(t){s=t.GameLogger}],execute:function(){var d;r._RF.push({},"3315fOPsEhPJ68OPuNGzdNp","GridCell",void 0);var l=e.ccclass;e.property,t("GridCell",l("GridCell")(d=function(t){function r(){for(var i,r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).gridPosition=new n(0,0),i.gridItems=[],i.gridItemOrder=[],i}i(r,t);var e=r.prototype;return e.init=function(t){this.gridPosition=t},e.getCellIndexInGrid=function(){return{row:this.gridPosition.x,col:this.gridPosition.y}},e.addGridItem=function(t){if(!t)return s.error("Invalid item component"),!1;var i=t.getItemType();return-1!==this.gridItemOrder.indexOf(i)?(s.warn("Item type "+i+" already exists in this cell"),!1):(this.gridItems.push(t),this.gridItemOrder.push(i),t.onAddGridItem({col:this.gridPosition.y,row:this.gridPosition.x}),!0)},e.popItem=function(){return 0===this.gridItems.length?null:(this.gridItemOrder.pop(),this.gridItems.pop())},e.getFirstGridItem=function(){return 0===this.gridItems.length?null:this.gridItems[this.gridItems.length-1]},e.getGridItemByType=function(t){var i=this.gridItemOrder.indexOf(t.name);return-1===i?null:this.gridItems[i]},e.getCellPosition=function(){var t=this.node.position;return{x:t.x,y:t.y}},r}(o))||d);r._RF.pop()}}}));

System.register("bundle://main/_virtual/GridGameLogic.ts",["cc"],(function(r){var o,a;return{setters:[function(r){o=r.cclegacy,a=r._decorator}],execute:function(){var t;o._RF.push({},"2733apAS5VJPIbOqlSi5NZZ","GridGameLogic",void 0);var e=a.ccclass;a.property,r("GridGameLogic",e("GridGameLogic")(t=function(){function r(){this.gameBoard=null}var o=r.prototype;return o.setGameBoard=function(r){this.gameBoard=r},o.getGameBoard=function(){return this.gameBoard},o.findAllMatchesInGrid=function(){if(!this.gameBoard)return[];for(var r=this.gameBoard.rows,o=this.gameBoard.cols,a=this.gameBoard.items,t=[],e=Array(r).fill(0).map((function(){return Array(o).fill(!1)})),i=0;i<r;i++){for(var c=1,s=1;s<o;s++)if(a[i][s].type===a[i][s-1].type)c++;else{if(c>=3)for(var n=s-c;n<s;n++)e[i][n]||(t.push({row:i,col:n}),e[i][n]=!0);if(c=1,s+3>o)break}if(c>=3)for(var f=o-c;f<o;f++)e[i][f]||(t.push({row:i,col:f}),e[i][f]=!0)}for(var l=0;l<o;l++){for(var m=1,h=1;h<r;h++)if(a[h][l].type===a[h-1][l].type)m++;else{if(m>=3)for(var u=h-m;u<h;u++)e[u][l]||(t.push({row:u,col:l}),e[u][l]=!0);if(m=1,h+3>r)break}if(m>=3)for(var d=r-m;d<r;d++)e[d][l]||(t.push({row:d,col:l}),e[d][l]=!0)}return t},o.findMatchesFromSwap=function(r,o){if(!this.gameBoard)return[];var a=this.gameBoard.items[r.row][r.col];this.gameBoard.items[r.row][r.col]=this.gameBoard.items[o.row][o.col],this.gameBoard.items[o.row][o.col]=a;var t=[].concat(this.findLocalMatches(r.row,r.col),this.findLocalMatches(o.row,o.col)),e=Array.from(new Map(t.map((function(r){return[r.row+","+r.col,r]}))).values());return this.gameBoard.items[o.row][o.col]=this.gameBoard.items[r.row][r.col],this.gameBoard.items[r.row][r.col]=a,e},o.findLocalMatches=function(r,o){for(var a=[],t=this.gameBoard.items,e=this.gameBoard.rows,i=this.gameBoard.cols,c=t[r][o].type,s=o;s>0&&t[r][s-1].type===c;)s--;for(var n=o;n<i-1&&t[r][n+1].type===c;)n++;if(n-s+1>=3)for(var f=s;f<=n;f++)f!==o&&a.push({row:r,col:f});for(var l=r;l>0&&t[l-1][o].type===c;)l--;for(var m=r;m<e-1&&t[m+1][o].type===c;)m++;if(m-l+1>=3)for(var h=l;h<=m;h++)h!==r&&a.push({row:h,col:o});return a.length>=2&&a.push({row:r,col:o}),a},o.findAllMatchCells=function(r){return this.findLocalMatches(r.row,r.col)},r}())||t);o._RF.pop()}}}));

System.register("bundle://main/_virtual/GridItemFlagsUtil.ts",["cc","./GameDataStructures.ts"],(function(s){var t,a,i;return{setters:[function(s){t=s.cclegacy,a=s._decorator},function(s){i=s.GridItemFlags}],execute:function(){var r;t._RF.push({},"29bd0ixJd1NeIHR4x36j2Wi","GridItemFlagsUtil",void 0);var n=a.ccclass;a.property,s("GridItemFlagsUtil",n("GridItemFlagsUtil")(r=function(){function s(){}return s.addFlags=function(s,t){return s|t},s.removeFlags=function(s,t){return s&~t},s.hasFlags=function(s,t){return(s&t)===t},s.toggleFlags=function(s,t){return s^t},s.flagsToString=function(s){var t=[];return this.hasFlags(s,i.SELECTABLE)&&t.push("SELECTABLE"),this.hasFlags(s,i.MOVABLE)&&t.push("MOVABLE"),this.hasFlags(s,i.DESTRUCTIBLE)&&t.push("DESTRUCTIBLE"),this.hasFlags(s,i.FROZEN)&&t.push("FROZEN"),this.hasFlags(s,i.LOCKED)&&t.push("LOCKED"),this.hasFlags(s,i.POWER_UP)&&t.push("POWER_UP"),this.hasFlags(s,i.EXPLODING)&&t.push("EXPLODING"),this.hasFlags(s,i.FALLING)&&t.push("FALLING"),this.hasFlags(s,i.SWAPPING)&&t.push("SWAPPING"),this.hasFlags(s,i.MATCHED)&&t.push("MATCHED"),t.length>0?t.join(" | "):"NONE"},s}())||r);t._RF.pop()}}}));

System.register("bundle://main/_virtual/GridManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseGridItem.ts","./GridCell.ts","./GameLogger.ts","./TweenPipeline.ts"],(function(e){var n,t,l,o,i,r,a,s,c,d,u,h,p,m,g;return{setters:[function(e){n=e.inheritsLoose,t=e.createForOfIteratorHelperLoose},function(e){l=e.cclegacy,o=e._decorator,i=e.UITransform,r=e.instantiate,a=e.tween,s=e.Vec3,c=e.Node,d=e.Vec2,u=e.Component},function(e){h=e.BaseGridItem},function(e){p=e.GridCell},function(e){m=e.GameLogger},function(e){g=e.TweenPipeline}],execute:function(){var f;l._RF.push({},"2d7f1vbFAlOj5sdVXZPK17Y","GridManager",void 0);var C=o.ccclass;o.property,e("GridManager",C("GridManager")(f=function(e){function l(){for(var n,t=arguments.length,l=new Array(t),o=0;o<t;o++)l[o]=arguments[o];return(n=e.call.apply(e,[this].concat(l))||this).rows=8,n.columns=8,n.cellWidth=0,n.cellHeight=0,n.gridCells=[],n.cellComponents=[],n.selectedCell=null,n.draggingCell=null,n.gridGameLogic=null,n.gameBoard=null,n.tweenPipeline=new g,n.itemPrefabs=[],n}n(l,e);var o=l.prototype;return o.start=function(){},o.setPrefabs=function(e){this.itemPrefabs=e},o.setGridGameLogic=function(e){this.gridGameLogic=e,this.gameBoard=e.getGameBoard()},o.initializeGrid=function(){var e=this;this.gridCells=[],this.cellComponents=[];var n=this.node.getComponent(i);if(n){var t=n.contentSize;this.cellWidth=(t.width-20)/this.columns,this.cellHeight=(t.height-20)/this.rows;for(var l=-t.width*n.anchorPoint.x,o=-t.height*n.anchorPoint.y,r=0;r<this.rows;r++){for(var a=[],s=[],u=function(){var n=new c("Cell_"+r+"_"+h);n.setPosition(l+h*e.cellWidth+e.cellWidth/2+10,o+t.height-10-r*e.cellHeight-e.cellHeight/2);var u=n.addComponent(i);u.contentSize.set(e.cellWidth,e.cellHeight),u.anchorPoint.set(.5,.5);var m=n.addComponent(p);m.init(new d(r,h)),n.on(c.EventType.MOUSE_DOWN,(function(n){e.onMouseDown(n,m)}),e),n.on(c.EventType.MOUSE_UP,(function(n){e.onMouseUp(n,m)}),e),n.parent=e.node,a.push(n),s.push(m)},h=0;h<this.columns;h++)u();this.gridCells.push(a),this.cellComponents.push(s)}}else m.error("Grid container must have a UITransform component")},o.getAllCellComponents=function(){return this.cellComponents},o.getCellComponent=function(e,n){return e>=0&&e<this.rows&&n>=0&&n<this.columns?this.cellComponents[e][n]:null},o.getCellComponentByPos=function(e){return this.getCellComponent(e.row,e.col)},o.placePrefabInCell=function(e,n,t){var l=this.getCellComponent(n,t);if(l){l.node.destroyAllChildren();var o=this.createItemFromPrefab(e);return o?(o.node.parent=l.node,o.node.setPosition(0,0),o.onPlacedInCell({col:t,row:n}),l.addGridItem(o),o):null}return null},o.createItemFromPrefab=function(e){var n=r(e),t=n.getComponent(h);return null===t&&(t=n.addComponent(h)),t},o.placeMultiplePrefabsInCells=function(e){for(var n,l=[],o=t(e);!(n=o()).done;){var i=n.value,r=this.placePrefabInCell(i.prefab,i.row,i.col).node;l.push(r)}return l},o.getRows=function(){return this.rows},o.setRows=function(e){this.rows=e},o.getColumns=function(){return this.columns},o.setColumns=function(e){this.columns=e},o.onMouseDown=function(e,n){this.draggingCell=n},o.onMouseUp=function(e,n){var t=this.draggingCell===n?this.selectedCell:this.draggingCell;this.draggingCell=null,this.selectedCell=null,this.areAdjencientCells(n,t)?this.handleCellSwapRequest(n,t):(this.selectedCell=t||n,this.handleCellSelection(n))},o.areAdjencientCells=function(e,n){if(!e||!n)return!1;var t=e.getCellIndexInGrid(),l=n.getCellIndexInGrid(),o=Math.abs(t.col-l.col),i=Math.abs(t.row-l.row);return(1==o||1==i)&&o+i==1},o.swapCells=function(e,n){this.gameBoard.swapItems(e.getCellIndexInGrid(),n.getCellIndexInGrid());var t=e.popItem(),l=n.popItem();e.addGridItem(l),n.addGridItem(t)},o.handleCellSwapRequest=function(e,n){var t,l,o=this,i=e.getFirstGridItem(),r=n.getFirstGridItem();this.tweenPipeline.addParallel([a(i.node).call((function(){i.node.parent=n.node})).to(.3,new s(0,0,0)),a(r.node).call((function(){r.node.parent=e.node})).to(.3,new s(0,0,0)),a({}).call((function(){o.swapCells(e,n),t=o.gridGameLogic.findAllMatchCells(e.getCellIndexInGrid()),l=o.gridGameLogic.findAllMatchCells(n.getCellIndexInGrid())}))]).addCallback((function(){t.length>=3||l.length>=3?o.handleMatchedCells(t.concat(l)):o.tweenPipeline.addParallel([a(i.node).call((function(){i.node.parent=e.node})).to(.3,new s(0,0,0)),a(r.node).call((function(){r.node.parent=n.node})).to(.3,new s(0,0,0)),a({}).call((function(){o.swapCells(e,n)}))])}))},o.handleMatchedCells=function(e){for(var n,l=this,o=[],i=[],r=function(){var e=n.value,t=l.getCellComponent(e.row,e.col),i=null==t?void 0:t.popItem(),r=a(i.node).to(.5,{scale:new s(0,0,0)}).call((function(){i.node.destroy()}));o.push(r)},c=t(e);!(n=c()).done;)r();var d=a({}).call((function(){l.gameBoard.removeItems(e),new Set(e.map((function(e){return e.col}))).forEach((function(e){var n=l.gameBoard.colItemsDown(e),t=n[0],o=n[1];t.length>0&&i.push.apply(i,t);for(var r=l.gameBoard.getRandomItemTypesBulk(o),a=r.map((function(e){return l.createItemFromPrefab(l.itemPrefabs[e])})),s=o-1;s>=0;--s)l.gameBoard.addItem({row:s,col:e},{type:r[s],flags:0}),i.push({from:{row:s-o,col:e},to:{row:s,col:e},item:a[s]})}))}));o.push(d),this.tweenPipeline.addParallel(o),this.tweenPipeline.addCallback((function(){var e=i.map((function(e){var n=e.from,t=e.to,o=e.item,i=n.row>=0?l.getCellComponentByPos(n).popItem():o,r=l.getCellComponentByPos(t);return a(i.node).call((function(){i.node.parent=r.node,n.row<0&&i.node.setPosition(0,(t.row-n.row)*l.cellHeight,0)})).to(.05,{position:new s(0,0,0)}).call((function(){r.addGridItem(i)}))}));l.tweenPipeline.addParallel(e),l.tweenPipeline.addCallback((function(){var e=l.gridGameLogic.findAllMatchesInGrid();e.length>0&&l.handleMatchedCells(e)}))}))},o.handleCellSelection=function(e){var n;null==e||null==(n=e.getFirstGridItem())||n.onItemSelected()},l}(u))||f);l._RF.pop()}}}));

System.register("bundle://main/_virtual/main",["./BaseGridItem.ts","./GameBoard.ts","./GameConfig.ts","./GameController.ts","./GameDataStructures.ts","./GameLogger.ts","./GridCell.ts","./GridGameLogic.ts","./GridItemFlagsUtil.ts","./GridManager.ts","./TweenPipeline.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("bundle://main/_virtual/rollupPluginModLoBabelHelpers.js",[],(function(t){return{execute:function(){function e(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function n(e){return(n=t("getPrototypeOf",Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)}))(e)}function o(e,r){return(o=t("setPrototypeOf",Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t}))(e,r)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(e,r,n){return(a=i()?t("construct",Reflect.construct.bind()):t("construct",(function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&o(i,r.prototype),i}))).apply(null,arguments)}function u(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function c(e){var r="function"==typeof Map?new Map:void 0;return(c=t("wrapNativeSuper",(function(t){if(null===t||!u(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return a(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)})))(e)}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function p(t){var e=s(t,"string");return"symbol"==typeof e?e:String(e)}t({applyDecoratedDescriptor:function(t,e,r,n,o){var i={};Object.keys(n).forEach((function(t){i[t]=n[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0);i=r.slice().reverse().reduce((function(r,n){return n(t,e,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0);void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null);return i},arrayLikeToArray:f,assertThisInitialized:function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},asyncToGenerator:function(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function u(t){e(a,o,i,u,c,"next",t)}function c(t){e(a,o,i,u,c,"throw",t)}u(void 0)}))}},construct:a,createClass:function(t,e,n){e&&r(t.prototype,e);n&&r(t,n);return Object.defineProperty(t,"prototype",{writable:!1}),t},createForOfIteratorHelperLoose:function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},getPrototypeOf:n,inheritsLoose:function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)},initializerDefineProperty:function(t,e,r,n){if(!r)return;Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})},isNativeFunction:u,isNativeReflectConstruct:i,regeneratorRuntime:function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t("regeneratorRuntime",(function(){return r}));var e,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new T(n||[]);return i(a,"_invoke",{value:E(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h="suspendedStart",y="executing",v="completed",d={};function g(){}function b(){}function m(){}var w={};f(w,u,(function(){return this}));var O=Object.getPrototypeOf,L=O&&O(O(k([])));L&&L!==n&&o.call(L,u)&&(w=L);var j=m.prototype=g.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,i,a,u){var c=p(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function E(t,r,n){var o=h;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=p(t,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function _(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,_(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=p(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function k(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=m,i(j,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:b,configurable:!0}),b.displayName=f(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},x(P.prototype),f(P.prototype,c,(function(){return this})),r.AsyncIterator=P,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new P(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(j),f(j,l,"Generator"),f(j,u,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),d}},r},setPrototypeOf:o,toPrimitive:s,toPropertyKey:p,unsupportedIterableToArray:l,wrapNativeSuper:c})}}}));

System.register("bundle://main/_virtual/TweenPipeline.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,r,i,s,u,c;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){i=e.cclegacy,s=e._decorator,u=e.tween,c=e.Component}],execute:function(){var o;i._RF.push({},"7b98cQI+K5ILqm8w59ofG4l","TweenPipeline",void 0);var a=s.ccclass;s.property,e("TweenPipeline",a("TweenPipeline")(o=function(e){function i(){for(var n,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(n=e.call.apply(e,[this].concat(r))||this).tweenQueue=[],n.isProcessing=!1,n.currentTween=null,n}n(i,e);var s=i.prototype;return s.addTween=function(e,n){return this.tweenQueue.push({tween:e,description:n}),this.processQueue(),this},s.addParallel=function(e){var n,t=(n=u({})).parallel.apply(n,e);return this.addTween(t,"Parallel")},s.addCallback=function(e){var n=u({}).call((function(){e()}));return this.addTween(n,"Callback")},s.processQueue=function(){this.isProcessing||0===this.tweenQueue.length||(this.isProcessing=!0,this.executeNextTask())},s.executeNextTask=function(){var e=this;if(0!==this.tweenQueue.length){var n=this.tweenQueue.shift();this.currentTween=n.tween,this.currentTween.call((function(){e.executeNextTask()})),this.currentTween.start()}else this.isProcessing=!1},s.clearQueue=function(){this.tweenQueue=[],this.currentTween&&(this.currentTween.stop(),this.currentTween=null),this.isProcessing=!1},s.getRemainingTasks=function(){return this.tweenQueue.length},s.isRunning=function(){return this.isProcessing},s.waitForComplete=function(){var e=t(r().mark((function e(){var n=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(n.isProcessing||0!==n.tweenQueue.length){!function t(){n.isProcessing||0!==n.tweenQueue.length?setTimeout(t,16):e()}()}else e()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i}(c))||o);i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'bundle://main/_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
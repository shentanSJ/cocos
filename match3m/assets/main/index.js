System.register("chunks:///main.js",["cc","./rollupPluginModLoBabelHelpers-8eb20a6f.js"],(function(){var e,t,n,i,o,r,a,s,l,c,h,u,d,f,p,g,m,v,w,I,C,P,L,y,b,G,E,F,M;return{setters:[function(I){e=I.cclegacy,t=I._decorator,n=I.Animation,i=I.Component,I.log,o=I.resources,r=I.JsonAsset,a=I.SpriteFrame,s=I.ImageAsset,l=I.Texture2D,c=I.Prefab,h=I.AudioClip,u=I.Vec2,d=I.tween,f=I.UITransform,p=I.instantiate,g=I.Vec3,m=I.Node,v=I.AudioSource,w=I.Sprite},function(e){I=e.a,C=e.f,P=e.d,L=e.g,y=e.h,b=e.i,G=e.e,E=e._,F=e.b,M=e.c}],execute:function(){e._RF.push({},"c98229HNVpElaWhNlXJ3Z2Y","AliasRandom",void 0);var T,A=function(){function e(e,t){if(this.items=void 0,this.prob=void 0,this.alias=void 0,!Array.isArray(e)||!Array.isArray(t))throw new Error("items 和 weights 必须是数组");if(e.length!==t.length)throw new Error("items 和 weights 长度必须相同");if(0===e.length)throw new Error("items 不能为空");if(t.some((function(e){return"number"!=typeof e||e<0})))throw new Error("权重必须是非负数字");var n=t.reduce((function(e,t){return e+t}),0);if(0===n)throw new Error("权重总和不能为0");this.items=e;var i=e.length;this.prob=new Array(i),this.alias=new Array(i);for(var o=t.map((function(e){return e*i/n})),r=[],a=[],s=0;s<i;s++)o[s]<1?r.push(s):a.push(s);for(;r.length>0&&a.length>0;){var l=r.pop(),c=a.pop();this.prob[l]=o[l],this.alias[l]=c,o[c]=o[c]+o[l]-1,o[c]<1?r.push(c):a.push(c)}for(;a.length>0;){var h=a.pop();this.prob[h]=1}for(;r.length>0;){var u=r.pop();this.prob[u]=1}}var t=e.prototype;return t.choice=function(){var e=this.items.length,t=Math.floor(Math.random()*e);return Math.random()<this.prob[t]?this.items[t]:this.items[this.alias[t]]},t.choices=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.choice();return t},e}();e._RF.pop(),e._RF.push({},"45648GThn5KOKCFXtNotryZ","BaseGridItem",void 0);var R=t.ccclass,S=(t.property,R("BaseGridItem")(T=function(e){function t(){return e.apply(this,arguments)||this}I(t,e);var i=t.prototype;return i.onPlacedInCell=function(e){this.playAnimation("placed")},i.onItemSelected=function(){this.playAnimation("click")},i.onAddGridItem=function(e){this.playAnimation("ItemAdded")},i.onRemovedFromCell=function(){this.playAnimation("removed")},i.onCellInteraction=function(e){this.playAnimation("interacted")},i.onCustomEvent=function(e,t){this.playAnimation(e)},i.activateSpecialEffect=function(){this.playAnimation("special_effect")},i.canMatchWith=function(e){return!0},i.playAnimation=function(e){var t=this.getComponent(n);t&&t.getState(e)&&t.play(e)},t}(i))||T);e._RF.pop(),e._RF.push({},"56976t0q5pHpoVUvlI+8xVf","GameBoard",void 0);var N,_,k=function(){function e(){this.board={rows:0,cols:0,deep:1,items:[]},this.itemConfigs=void 0,this.aliasRandom=void 0}var t=e.prototype;return t.getInstance=function(){return this},t.setBoardSize=function(e,t,n){void 0===n&&(n=1),this.board.rows=e,this.board.cols=t,this.board.deep=n},t.setItemConfigs=function(e){this.itemConfigs=e,null!==this.aliasRandom&&delete this.aliasRandom,this.aliasRandom=new A(this.itemConfigs,this.itemConfigs.map((function(e){return e.weight})))},t.getItemConfig=function(e){return this.itemConfigs[e]},t.createRandomItems=function(e){return this.aliasRandom.choices(e)},t.initializeItems=function(){for(var e=this.board.rows,t=this.board.cols,n=[],i=e*t,o=this.createRandomItems(i),r=0,a=0;a<e;a++){for(var s=[],l=0;l<t;l++){var c=o[r++];s.push([c])}n.push(s)}this.board.items=n},t.getItemsInPos=function(e){return this.board.items[e.row][e.col]},t.swapItemsInFirstLayer=function(e,t){var n=this.popItemInPos(e),i=this.popItemInPos(t);this.addItemInPos(t,n),this.addItemInPos(e,i)},t.popItemInPos=function(e){return this.getItemsInPos(e).pop()},t.getFirstItemInPos=function(e){var t=this.getItemsInPos(e);return t[t.length-1]},t.isEmpty=function(e){return 0===this.getItemsInPos(e).length},t.addItemInPos=function(e,t){this.getItemsInPos(e).push(t)},t.updateItemInPos=function(e,t,n){void 0===n&&(n=1);var i=this.getItemsInPos(e),o=i.length;if(n<=o){var r=o-n;i[r]=C({},i[r],t)}},P(e,[{key:"rowLength",get:function(){return this.board.rows}},{key:"colLength",get:function(){return this.board.cols}},{key:"items",get:function(){return this.board.items}}]),e}();e._RF.pop(),e._RF.push({},"92601G+iWNNn7IOLtYUUsGY","GameLogger",void 0);var O,B,D=t.ccclass,x=(t.property,D("GameLogger")(((_=function(e){function t(){return e.apply(this,arguments)||this}return I(t,e),t.enableLogging=function(e){t.loggingEnabled=e},t.log=function(e){t.loggingEnabled,0},t.error=function(e){},t.warn=function(e){},t}(i)).loggingEnabled=!0,N=_))||N);e._RF.pop(),e._RF.push({},"c40fdRXSOtODI4tDrxLUt0c","GameConfig",void 0);var W,U=t.ccclass,H=(t.property,U("GameConfig")(((B=function(e){function t(){return e.apply(this,arguments)||this}return I(t,e),t.createItemTypeWeightsMap=function(e){if(!e)return x.error("No theme config loaded, create an empty Map!"),new Map;var t=new Map,n=e.itemTypeWeights||[],i=e.itemPrefabPaths.length;if(0===n.length)for(var o=0;o<i;o++)t.set(o,1);else{for(var r=0;r<Math.min(n.length,i);r++)t.set(r,n[r]);for(var a=n.length;a<i;a++)t.set(a,1)}return t},t.getPrefab=function(e){var t;return null==(t=this.currentTheme)?void 0:t.prefabConfigs[e]},t.getLastThemeId=function(){try{return localStorage.getItem(this.LAST_THEME_KEY)||"default"}catch(e){return"default"}},t.saveLastThemeId=function(e){try{localStorage.setItem(this.LAST_THEME_KEY,e)}catch(e){}},t.loadThemeConfig=function(e,t){var n=this,i="themes/"+e+"/config";o.load(i,r,(function(e,i){if(e)t(null);else{var o=i.json;n.currentTheme=o,t(o)}}))},t.getCurrentTheme=function(){return this.currentTheme},t.loadBackgroundImage=function(e){var t=this;if(this.currentTheme){var n=this.prependThemePath(this.currentTheme.backgroundPath);if(n)if(this.assetCache.has(n))e(this.assetCache.get(n));else{var i=n.endsWith("/spriteFrame")?n:n+"/spriteFrame";o.load(i,a,(function(i,o){if(!i)return t.assetCache.set(n,o),void e(o);t.loadImageAsSpriteFrame(n,e)}))}else e(null)}else e(null)},t.loadImageAsSpriteFrame=function(e,t){var n=this;o.load(e,s,(function(i,o){if(i)t(null);else{var r=new a,s=new l;s.image=o,r.texture=s,n.assetCache.set(e,r),t(r)}}))},t.loadItemPrefabs=function(e){var t=this;if(this.currentTheme){var n=this.currentTheme.prefabConfigs.map((function(e){return t.prependThemePath(e.path)}));o.load(n,c,(function(n,i){if(n);else{for(var o=0;o<i.length;o++){var r=i[o];t.currentTheme.prefabConfigs[o].prefab=r}e(t.currentTheme.prefabConfigs)}}))}else e(null)},t.loadAudioClip=function(e,t){var n=this;if(this.currentTheme){var i=this.prependThemePath(this.currentTheme.audioPaths[e]);i?this.assetCache.has(i)?t(this.assetCache.get(i)):o.load(i,h,(function(e,o){e?t(null):(n.assetCache.set(i,o),t(o))})):t(null)}else t(null)},t.clearCache=function(){this.assetCache.clear()},t.getAvailableThemes=function(e){o.loadDir("themes",(function(t,n){if(t)e([]);else{var i=new Set;e(Array.from(i))}}))},t.prependThemePath=function(e){return e&&this.currentTheme?e.startsWith("themes/")?e:"themes/"+this.currentTheme.themeId+"/"+e:e},t}(L(Object))).LAST_THEME_KEY="match_three_last_theme",B.currentTheme=null,B.assetCache=new Map,O=B))||O);e._RF.pop(),e._RF.push({},"3315fOPsEhPJ68OPuNGzdNp","GridCell",void 0);var Q,z=t.ccclass,K=(t.property,z("GridCell")(W=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).gridPosition=new u(0,0),t}I(t,e);var n=t.prototype;return n.init=function(e){this.gridPosition=e},n.getCellIndexInGrid=function(){return{row:this.gridPosition.x,col:this.gridPosition.y}},n.getCellPosition=function(){var e=this.node.position;return{x:e.x,y:e.y}},t}(i))||W);e._RF.pop(),e._RF.push({},"7b98cQI+K5ILqm8w59ofG4l","TweenPipeline",void 0);var V,j=t.ccclass,Z=(t.property,j("TweenPipeline")(Q=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).tweenQueue=[],t.isProcessing=!1,t.currentTween=null,t}I(t,e);var n=t.prototype;return n.addTween=function(e,t){return this.tweenQueue.push({tween:e,description:t}),this.processQueue(),this},n.addParallel=function(e,t){var n,i=(n=d({})).parallel.apply(n,e);return this.addTween(i,t||"Parallel")},n.addCallback=function(e,t){var n=d({}).call((function(){e()}));return this.addTween(n,t||"Callback")},n.processQueue=function(){this.isProcessing||0===this.tweenQueue.length||(this.isProcessing=!0,this.executeNextTask())},n.executeNextTask=function(){var e=this;if(0!==this.tweenQueue.length){var t=this.tweenQueue.shift();this.currentTween=t.tween,this.currentTween.call((function(){e.currentTween=null,e.isProcessing=!1,e.processQueue()})),this.currentTween.start()}else this.isProcessing=!1},n.clearQueue=function(){this.tweenQueue=[],this.currentTween&&(this.currentTween.stop(),this.currentTween=null),this.isProcessing=!1},n.getRemainingTasks=function(){return this.tweenQueue.length},n.isRunning=function(){return this.isProcessing},n.waitForComplete=function(){var e=y(b().mark((function e(){var t=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(t.isProcessing||0!==t.tweenQueue.length){!function n(){t.isProcessing||0!==t.tweenQueue.length?setTimeout(n,16):e()}()}else e()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(i))||Q);e._RF.pop(),e._RF.push({},"2d7f1vbFAlOj5sdVXZPK17Y","GridManager",void 0);var X=t.ccclass,Y=(t.property,X("GridManager")(V=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).rowLength=8,t.colLength=8,t.cellWidth=0,t.cellHeight=0,t.gridCells=[],t.cellComponents=[],t.selectedCell=null,t.draggingCell=null,t.gridGameLogic=null,t.tweenPipeline=new Z,t.lastMatchTimeStamp=0,t.simplePlayer=null,t.mouseEnabled=!0,t}I(t,e);var n=t.prototype;return n.start=function(){},n.setSimplePlayer=function(e){this.simplePlayer=e},n.setGridGameLogic=function(e){this.gridGameLogic=e,this.rowLength=e.rowLength,this.colLength=e.colLength},n.setMouseEnabled=function(e){this.mouseEnabled=e},n.initializeGrid=function(){var e=this;this.gridCells=[],this.cellComponents=[];var t=this.node.getComponent(f);if(t){var n=t.contentSize;this.cellWidth=(n.width-20)/this.colLength,this.cellHeight=(n.height-20)/this.rowLength;for(var i=-n.width*t.anchorPoint.x,o=-n.height*t.anchorPoint.y,r=0;r<this.rowLength;r++){for(var a=[],s=[],l=function(){var t=new m("Cell_"+r+"_"+c);t.setPosition(i+c*e.cellWidth+e.cellWidth/2+10,o+n.height-10-r*e.cellHeight-e.cellHeight/2);var l=t.addComponent(f);l.contentSize.set(e.cellWidth,e.cellHeight),l.anchorPoint.set(.5,.5);var h=t.addComponent(K);h.init(new u(r,c)),t.on(m.EventType.MOUSE_DOWN,(function(t){e.mouseEnabled&&e.onMouseDown(t,h)}),e),t.on(m.EventType.MOUSE_UP,(function(t){e.mouseEnabled&&e.onMouseUp(t,h)}),e),t.parent=e.node,a.push(t),s.push(h)},c=0;c<this.colLength;c++)l();this.gridCells.push(a),this.cellComponents.push(s)}}else x.error("Grid container must have a UITransform component")},n.getCellComponent=function(e){var t=e.row,n=e.col;return t>=0&&t<this.rowLength&&n>=0&&n<this.colLength?this.cellComponents[t][n]:null},n.placePrefabInCell=function(e,t){var n=this.getCellComponent(t),i=e.prefab;if(n){var o=this.createItemFromPrefab(i);return o?(o.node.parent=n.node,o.node.setPosition(0,0,0),o):null}return null},n.createItemFromPrefab=function(e){var t=p(e),n=t.getComponent(S);return null===n&&(n=t.addComponent(S)),n},n.onMouseDown=function(e,t){this.mouseEnabled&&(this.draggingCell=t)},n.onMouseUp=function(e,t){if(this.mouseEnabled){var n=this.draggingCell===t?this.selectedCell:this.draggingCell;if(this.draggingCell=null,this.selectedCell=null,null===n||!this.gridGameLogic.areAdjacentCells(t.getCellIndexInGrid(),n.getCellIndexInGrid()))return this.selectedCell=n||t,void this.handleCellSelection(t);this.handleCellSwapRequest(t,n)}},n.handleCellSwapRequest=function(e,t){var n=this;this.setMouseEnabled(!1);var i,o,r=e.getCellIndexInGrid(),a=t.getCellIndexInGrid(),s=this.gridGameLogic.getFirstItemInPos(r).gridItem,l=this.gridGameLogic.getFirstItemInPos(a).gridItem;this.tweenPipeline.addParallel([d(s.node).call((function(){s.node.parent=t.node})).to(.3,new g(0,0,0)),d(l.node).call((function(){l.node.parent=e.node})).to(.3,new g(0,0,0)),d({}).call((function(){n.gridGameLogic.swapItemsInFirstLayer(r,a),i=n.gridGameLogic.findLocalMatches(r),o=n.gridGameLogic.findLocalMatches(a)}))]).addCallback((function(){if(i.length>=3||o.length>=3){var c=new Set(i.concat(o));n.lastMatchTimeStamp=Date.now(),n.handleMatchedCells(Array.from(c))}else n.tweenPipeline.addParallel([d(s.node).call((function(){s.node.parent=e.node})).to(.3,new g(0,0,0)),d(l.node).call((function(){l.node.parent=t.node})).to(.3,new g(0,0,0)),d({}).call((function(){n.gridGameLogic.swapItemsInFirstLayer(r,a)}))]),n.tweenPipeline.addCallback((function(){n.setMouseEnabled(!0)}))}))},n.handleMatchedCells=function(e){for(var t,n=this,i=[],o=[],r=G(e);!(t=r()).done;){var a=t.value,s=this.gridGameLogic.popItemInPos(a).gridItem,l=d(s.node).to(.5,{scale:new g(0,0,0)}).destroySelf();i.push(l)}var c=d({}).call((function(){new Set(e.map((function(e){return e.col}))).forEach((function(e){var t=n.gridGameLogic.colItemsMoveDownPlan(e),i=t.filter((function(e){return e.from.row<0})),r=n.gridGameLogic.createRandomItems(i.length);t.forEach((function(e){var t,i,a=n.getCellComponent(e.to);e.from.row>=0?((i=(t=n.gridGameLogic.popItemInPos(e.from)).gridItem).node.parent=a.node,i.node.setPosition(0,(e.to.row-e.from.row)*n.cellHeight,0)):(t=r.shift(),i=n.placePrefabInCell(t,e.to),t.gridItem=i,i.node.setPosition(0,(e.to.row-e.from.row)*n.cellHeight+20,0)),o.push(C({itemConfig:C({},t)},e))}))}))}));i.push(c),this.tweenPipeline.addParallel(i,"destroy matched items"),this.tweenPipeline.addCallback((function(){var e=o.map((function(e){var t=e.itemConfig,i=e.to;return d(t.gridItem.node).call((function(){n.gridGameLogic.addItemInPos(i,t)})).to(.05,{position:new g(0,0,0)})}));n.tweenPipeline.addParallel(e,"play mmove down animations"),n.tweenPipeline.addCallback((function(){n.autoCheckMatches()}),"Auto check if contained matched cells")}),"move down items to fulfilled cells")},n.handleCellSelection=function(e){var t=e.getCellIndexInGrid();this.gridGameLogic.getFirstItemInPos(t).gridItem.onItemSelected()},n.autoCheckMatches=function(){var e=this.gridGameLogic.findAllMatchesInGrid();e.length>0?this.handleMatchedCells(e):this.CheckAndReinitiateGameBoardIfNeeded()},n.CheckAndReinitiateGameBoardIfNeeded=function(){null!==this.simplePlayer?null===this.simplePlayer.nextPossibleMove(this.gridGameLogic)?(console.log("No possible move, reinitiate game board"),this.reinitiateGameBoardItems(),this.autoCheckMatches()):this.setMouseEnabled(!0):this.setMouseEnabled(!0)},n.demoStep=function(e,t){var n=this.gridGameLogic.getFirstItemInPos(e).gridItem,i=this.gridGameLogic.getFirstItemInPos(t).gridItem,o=n.node.parent,r=i.node.parent;this.setMouseEnabled(!1),this.tweenPipeline.addParallel([d(n.node).call((function(){n.node.parent=r})).to(.3,new g(0,0,0)),d(i.node).call((function(){i.node.parent=o})).to(.3,new g(0,0,0))]),this.tweenPipeline.addParallel([d(n.node).call((function(){n.node.parent=r})).to(.3,new g(0,0,0)),d(i.node).call((function(){i.node.parent=o})).to(.3,new g(0,0,0))]),this.setMouseEnabled(!0)},n.populateGrid=function(e,t){for(var n=0;n<e;n++)for(var i=0;i<t;i++){var o=this.gridGameLogic.getFirstItemInPos({row:n,col:i}).id,r=H.getPrefab(o),a=this.placePrefabInCell(r,{row:n,col:i});a&&this.gridGameLogic.updateItemInPos({row:n,col:i},{gridItem:a})}},n.reinitiateGameBoardItems=function(){this.cleanup(),this.gridGameLogic.initializeItems(),this.populateGrid(this.gridGameLogic.rowLength,this.gridGameLogic.colLength)},n.cleanup=function(){for(var e=0;e<this.rowLength;e++)for(var t=0;t<this.colLength;t++)this.gridCells[e][t].destroyAllChildren()},t}(i))||V);e._RF.pop(),e._RF.push({},"2733apAS5VJPIbOqlSi5NZZ","GridGameLogic",void 0);t.ccclass,t.property;var q=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).specialItemConfigs=[],t}I(t,e);var n=t.prototype;return n.setItemConfigs=function(t){this.specialItemConfigs=t.filter((function(e){return e.type>=1e3})),e.prototype.setItemConfigs.call(this,t.filter((function(e){return e.type<1e3})))},n.areItemsMatched=function(e,t){var n=this.getFirstItemInPos(e),i=this.getFirstItemInPos(t);return!(!n||!i)&&n.name===i.name},n.findAllMatchesInGrid=function(){for(var e=this.rowLength,t=this.colLength,n=[],i=Array(e).fill(0).map((function(){return Array(t).fill(!1)})),o=0;o<e;o++){for(var r=1,a=1;a<t;a++)if(this.areItemsMatched({row:o,col:a},{row:o,col:a-1}))r++;else{if(r>=3)for(var s=a-r;s<a;s++)i[o][s]||(n.push({row:o,col:s}),i[o][s]=!0);if(r=1,a+3>t)break}if(r>=3)for(var l=t-r;l<t;l++)i[o][l]||(n.push({row:o,col:l}),i[o][l]=!0)}for(var c=0;c<t;c++){for(var h=1,u=1;u<e;u++)if(this.areItemsMatched({row:u,col:c},{row:u-1,col:c}))h++;else{if(h>=3)for(var d=u-h;d<u;d++)i[d][c]||(n.push({row:d,col:c}),i[d][c]=!0);if(h=1,u+3>e)break}if(h>=3)for(var f=e-h;f<e;f++)i[f][c]||(n.push({row:f,col:c}),i[f][c]=!0)}return n},n.findLocalMatches=function(e){for(var t=[],n=this.rowLength,i=this.colLength,o=e.row,r=e.col,a=r;a>0&&this.areItemsMatched({row:o,col:a-1},{row:o,col:a});)a--;for(var s=r;s<i-1&&this.areItemsMatched({row:o,col:s+1},{row:o,col:s});)s++;if(s-a+1>=3)for(var l=a;l<=s;l++)l!==r&&t.push({row:o,col:l});for(var c=o;c>0&&this.areItemsMatched({row:c-1,col:r},{row:o,col:r});)c--;for(var h=o;h<n-1&&this.areItemsMatched({row:h+1,col:r},{row:o,col:r});)h++;if(h-c+1>=3)for(var u=c;u<=h;u++)u!==o&&t.push({row:u,col:r});return t.length>=2&&t.push({row:o,col:r}),t},n.colItemsMoveDownPlan=function(e){console.log("planning col move down...........");for(var t=[],n=[],i=0,o=-1,r=this.rowLength-1;r>=0;--r)if(this.isEmpty({row:r,col:e})){o=r,i++;break}for(var a=o-1;a>=0;--a)this.isEmpty({row:a,col:e})?i++:n.push(a);for(var s=n.length-1;s>=0;--s,--o){var l={row:n.shift(),col:e},c={row:o,col:e};t.push({from:l,to:c})}for(var h=-1;i>0;--h,--o,--i){var u={row:o,col:e},d={row:h,col:e};t.push({from:d,to:u})}return t},n.areAdjacentCells=function(e,t){if(!e||!t)return!1;var n=Math.abs(e.col-t.col),i=Math.abs(e.row-t.row);return(1==n||1==i)&&n+i==1},t}(k);e._RF.pop(),e._RF.push({},"d77c0Mq695K/pQMZ7YojuC2","SimpleBrainPlayer",void 0);var J,$,ee,te,ne,ie,oe,re,ae,se=function(){function e(e){this._playerName=void 0,this._playerName=e}return e.prototype.nextPossibleMove=function(e){var t=e.rowLength,n=e.colLength,i=null;var o=function(e){for(var i=0;i<t;i++)for(var o=[],r=[],a=0;a<n;a++){var s=e(i,a);if(o.push(s),r.push(a),!(a<3)){if(!(new Set(o).size>2))return o[0]===o[1]?{startPos:{row:i,col:r[2]},adjPos:{row:i,col:r[3]}}:{startPos:{row:i,col:r[0]},adjPos:{row:i,col:r[1]}};o.shift(),r.shift()}}return null};return null!=(i=o((function(t,n){return e.getFirstItemInPos({row:t,col:n}).name})))?i:i=o((function(t,n){return e.getFirstItemInPos({row:n,col:t}).name}))},P(e,[{key:"playerName",get:function(){return this._playerName}}]),e}();e._RF.pop(),e._RF.push({},"735bf8yxWREfpH0xZoxkuuB","GameController",void 0);var le=t.ccclass,ce=t.property;J=le("GameController"),$=ce(Y),ee=ce({type:m}),te=ce({type:v}),J((oe=E((ie=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,F(t,"gridManager",oe,M(t)),t.gridGameLogic=null,t.themeConfig=null,t.prefabsLoadedPromise=null,t.prefabsLoadedResolver=null,F(t,"backgroundNode",re,M(t)),F(t,"audioSource",ae,M(t)),t}I(t,e);var n=t.prototype;return n.start=function(){var e=this;if(this.gridManager){var t=performance.now();x.log("Game started at "+t);var n=H.getLastThemeId();H.loadThemeConfig(n,(function(t){t&&(e.themeConfig=t,e.loadGameBackground(),e.loadItemPrefabs(),e.loadAudioClip(),e.startNewGame())}))}else x.error("GridManager component is missing,  game cannot start")},n.startNewGame=function(){var e,t=this,n=this.themeConfig.rowCount||9,i=this.themeConfig.columnCount||9;(this.gridGameLogic=new q,this.gridGameLogic.setBoardSize(n,i),this.gridGameLogic.setItemConfigs(this.themeConfig.prefabConfigs),this.gridGameLogic.initializeItems(),this.gridManager.setGridGameLogic(this.gridGameLogic),this.gridManager)&&(this.gridManager.initializeGrid(),this.gridManager.setSimplePlayer(new se("Player1")),null==(e=this.prefabsLoadedPromise)||e.then((function(){t.gridManager.populateGrid(n,i)})).then((function(){t.gridManager.autoCheckMatches()})))},n.loadGameBackground=function(){var e=this;H.loadBackgroundImage((function(t){if(t&&e.backgroundNode){var n=e.backgroundNode.getComponent(w);n?n.spriteFrame=t:x.warn("Background node does not have a Sprite component")}}))},n.loadItemPrefabs=function(){var e=this;this.prefabsLoadedPromise=new Promise((function(t){e.prefabsLoadedResolver=t})),H.loadItemPrefabs((function(t){e.prefabsLoadedResolver&&e.prefabsLoadedResolver()}))},n.loadAudioClip=function(){var e=this;H.loadAudioClip("backgroundMusic",(function(t){t&&e.audioSource&&(e.audioSource.clip=t,e.audioSource.loop=!0,e.audioSource.play()),x.log("Audio resources loaded at time "+performance.now())}))},n.playSound=function(e){var t=this;H.loadAudioClip(e,(function(e){e&&t.audioSource&&t.audioSource.playOneShot(e)}))},n.changeTheme=function(e){var t=this;H.clearCache(),H.loadThemeConfig(e,(function(e){e&&(t.loadGameBackground(),t.loadItemPrefabs(),t.loadAudioClip(),e.rowCount===t.themeConfig.rowCount&&e.columnCount===t.themeConfig.columnCount||(t.themeConfig=e,t.startNewGame()))}))},t}(i)).prototype,"gridManager",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=E(ie.prototype,"backgroundNode",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=E(ie.prototype,"audioSource",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=ie));e._RF.pop(),e._RF.push({},"5bcfdFO+lNLvqF08BuKfyAu","GameDataStructures",void 0);var he,ue=function(e){return e[e.NONE=0]="NONE",e[e.SELECTABLE=1]="SELECTABLE",e[e.MOVABLE=2]="MOVABLE",e[e.DESTRUCTIBLE=4]="DESTRUCTIBLE",e[e.FROZEN=8]="FROZEN",e[e.LOCKED=16]="LOCKED",e[e.POWER_UP=32]="POWER_UP",e[e.EXPLODING=64]="EXPLODING",e[e.FALLING=128]="FALLING",e[e.SWAPPING=256]="SWAPPING",e[e.MATCHED=512]="MATCHED",e}({});e._RF.pop(),e._RF.push({},"29bd0ixJd1NeIHR4x36j2Wi","GridItemFlagsUtil",void 0);var de=t.ccclass;t.property,de("GridItemFlagsUtil")(he=function(){function e(){}return e.addFlags=function(e,t){return e|t},e.removeFlags=function(e,t){return e&~t},e.hasFlags=function(e,t){return(e&t)===t},e.toggleFlags=function(e,t){return e^t},e.flagsToString=function(e){var t=[];return this.hasFlags(e,ue.SELECTABLE)&&t.push("SELECTABLE"),this.hasFlags(e,ue.MOVABLE)&&t.push("MOVABLE"),this.hasFlags(e,ue.DESTRUCTIBLE)&&t.push("DESTRUCTIBLE"),this.hasFlags(e,ue.FROZEN)&&t.push("FROZEN"),this.hasFlags(e,ue.LOCKED)&&t.push("LOCKED"),this.hasFlags(e,ue.POWER_UP)&&t.push("POWER_UP"),this.hasFlags(e,ue.EXPLODING)&&t.push("EXPLODING"),this.hasFlags(e,ue.FALLING)&&t.push("FALLING"),this.hasFlags(e,ue.SWAPPING)&&t.push("SWAPPING"),this.hasFlags(e,ue.MATCHED)&&t.push("MATCHED"),t.length>0?t.join(" | "):"NONE"},e}());e._RF.pop(),e._RF.push({},"f266a44DV5BlL2VKHpbaLpR","player",void 0),e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});